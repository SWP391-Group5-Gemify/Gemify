import{a as Me}from"./chunk-SJZSMRH2.js";import{b as Ae}from"./chunk-HGUFSTVI.js";import{a as Re}from"./chunk-64L7DANL.js";import{a as ge,b as _e,c as ye,e as ve,f as Se,h as Ie}from"./chunk-EMMCAKQR.js";import{a as be,b as Fe,c as xe,h as Pe}from"./chunk-F4T2NXLS.js";import"./chunk-3LYTN6OR.js";import"./chunk-QVLUA4QC.js";import{b as Ce,c as he}from"./chunk-VDIAIRGD.js";import{a as we}from"./chunk-V5J7M4I7.js";import{c as fe}from"./chunk-IMZNUD52.js";import{a as A,b as De}from"./chunk-5LB5J5WN.js";import{a as R}from"./chunk-JWFBI43Q.js";import"./chunk-BRZQVLQ6.js";import{a as V,b as k}from"./chunk-R2WOP35W.js";import{a as Ee}from"./chunk-J3BG4ZKK.js";import{a as ue,d as pe,g as de,h as me}from"./chunk-FXF7DOH7.js";import"./chunk-JJPOC4CD.js";import"./chunk-F2JFFDTT.js";import"./chunk-IJCGWU3B.js";import"./chunk-RGNDWIHZ.js";import"./chunk-J7DIVVOQ.js";import{a as x,b as P,ba as ce,n as z}from"./chunk-Y2G3PEDF.js";import{Fb as J,Ga as p,Ha as d,Hb as u,Nb as W,Oa as L,Pa as X,Pb as Y,Qb as Z,Rb as o,Sb as a,Tb as ee,Xb as _,_b as m,_c as oe,a as Q,ac as T,ad as ae,cd as se,dd as b,fc as B,fd as le,gc as $,gd as F,hc as j,ic as te,jc as l,kc as ne,la as I,lc as y,ma as H,mb as c,nb as g,ra as D,rc as re,sc as w,v as S,vc as M,wa as G,wc as v,xa as E,xc as q,ya as K,yc as ie}from"./chunk-5JFLDQZH.js";var Ne=(i,t)=>({"card-sale-counter--unassigned":i,"card-sale-counter--assigned":t}),Oe=(i,t)=>({"card-sale-counter__header--unassigned":i,"card-sale-counter__header--assigned":t}),Te=(i,t)=>({"btn--primary-dark":i,"btn--grad":t}),C,U=(C=class{constructor(t){this.employeeService=t,this.saleCounter=X.required(),this.onAssignEmployeeId=L()}ngOnInit(){this.loadAllSellersDropdown()}isUnassigned(){return this.saleCounter().userId==null}loadAllSellersDropdown(){this.employeeService.getAllSellers().pipe(k(this)).subscribe({next:t=>{this.allSellersDropdown=t.map(r=>({value:r.id,name:r.fullName}))},error(t){console.error(t)}})}onAssignEmployeeIdFromChild(t){let e={employeeId:t?.value,id:this.saleCounter().id};this.onAssignEmployeeId.emit(e)}onUnassignEmployeeFromCounter(){let t={employeeId:null,id:this.saleCounter().id};this.onAssignEmployeeId.emit(t)}},C.\u0275fac=function(r){return new(r||C)(g(Ae))},C.\u0275cmp=E({type:C,selectors:[["app-card-sale-counter"]],inputs:{saleCounter:[G.SignalBased,"saleCounter"],revenue:"revenue",selectedDate:"selectedDate"},outputs:{onAssignEmployeeId:"onAssignEmployeeId"},standalone:!0,features:[w],decls:27,vars:21,consts:[["allSellersDropdownRef",""],["appearance","outlined",1,"card-sale-counter",3,"ngClass"],[1,"card-sale-counter__header",3,"ngClass"],[1,"card-sale-counter__name"],[1,"card-sale-counter__content","u-margin-top-small"],[1,"card-sale-counter__quantity"],[1,"card-sale-counter__employee"],[1,"card-sale-counter__revenue"],[1,"card-sale-counter__actions"],["label","Ch\u1ECDn Nh\xE2n vi\xEAn",3,"onSelectionChange","options"],[1,"btn","btn--with-icon",3,"click","ngClass"]],template:function(r,e){if(r&1){let n=_();o(0,"mat-card",1)(1,"mat-card-header",2)(2,"mat-card-title",3)(3,"mat-icon"),l(4,"chair_alt"),a(),l(5),a()(),o(6,"mat-card-content",4)(7,"p",5),l(8,"T\u1ED5ng s\u1ED1 h\xE0ng: "),o(9,"span"),l(10),a()(),o(11,"p",6),l(12,"Nh\xE2n Vi\xEAn: "),o(13,"span"),l(14),a()(),o(15,"p",7),l(16),o(17,"span"),l(18),v(19,"currency"),a()()(),o(20,"mat-card-actions",8)(21,"app-generic-dropdown",9,0),m("onSelectionChange",function(f){return p(n),d(e.onAssignEmployeeIdFromChild(f))}),a(),o(23,"button",10),m("click",function(){return p(n),d(e.onUnassignEmployeeFromCounter())}),o(24,"mat-icon"),l(25,"delete"),a(),l(26,"H\u1EE7y l\xE0m vi\u1EC7c"),a()()()}r&2&&(u("ngClass",M(12,Ne,e.isUnassigned(),!e.isUnassigned())),c(),u("ngClass",M(15,Oe,e.isUnassigned(),!e.isUnassigned())),c(4),ne(e.saleCounter().name),c(5),y(" ",e.saleCounter().productQuantity,""),c(4),y(" ",e.saleCounter().userName,""),c(2),y("Doanh Thu Ng\xE0y ",e.selectedDate,": "),c(2),y(" ",ie(19,9,e.revenue,"VND"),""),c(3),u("options",e.allSellersDropdown),c(2),u("ngClass",M(18,Te,e.isUnassigned(),!e.isUnassigned())))},dependencies:[Ie,ge,ve,ye,Se,_e,fe,F,oe,le,De,A,R],styles:[".card-sale-counter--unassigned[_ngcontent-%COMP%]{border:3px solid #333}.card-sale-counter--assigned[_ngcontent-%COMP%]{border:3px solid #ea580c}.card-sale-counter__header[_ngcontent-%COMP%]{padding:2.4rem;color:#f5f5f4;font-size:1.6rem;text-align:center;text-transform:uppercase}.card-sale-counter__header--unassigned[_ngcontent-%COMP%]{background-color:#333}.card-sale-counter__header--assigned[_ngcontent-%COMP%]{background-color:#ea580c}.card-sale-counter__name[_ngcontent-%COMP%]{display:flex;align-items:center;gap:2.4rem}.card-sale-counter__content[_ngcontent-%COMP%]{padding:2.4rem;display:flex;flex-direction:column;gap:2.4rem}.card-sale-counter__quantity[_ngcontent-%COMP%], .card-sale-counter__employee[_ngcontent-%COMP%], .card-sale-counter__revenue[_ngcontent-%COMP%]{display:flex;justify-content:space-between;font-size:1.8rem}.card-sale-counter__quantity[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], .card-sale-counter__employee[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], .card-sale-counter__revenue[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-weight:900;font-size:2rem;color:#f97316}.card-sale-counter__actions[_ngcontent-%COMP%]{display:flex;flex-direction:column;padding:2.4rem;padding-top:0}"]}),C);U=S([V()],U);var Ve=(()=>{let t=class t{constructor(e){this.httpClient=e,this.baseSaleCounterUrl=Ee.baseApiUrl.concat("/saleCounters")}getSaleCounterById(e){return this.httpClient.get(`${this.baseSaleCounterUrl}/${e}`)}getCounters(e){let n=new x;return e.searchName&&(n=n.set("search",e.searchName)),(e.status===!0||e.status===!1)&&(n=n.set("status",e.status)),this.httpClient.get(this.baseSaleCounterUrl,{params:n})}assignEmployeeIdToCounter(e){let n=this.baseSaleCounterUrl.concat("/assign");return this.httpClient.patch(`${n}/${e.id}`,{userId:e.employeeId})}disableSaleCounter(e){return this.httpClient.delete(`${this.baseSaleCounterUrl}/${e}`)}getSaleCountersRevenueByDate(e){let n=this.baseSaleCounterUrl.concat("/bydate"),s=new x;return e.revenueDate&&(s=s.set("revenueDate",e.revenueDate.toString())),this.httpClient.get(n,{params:s})}getSaleCounterRevenueById(e,n){let s=new x;return n.pageIndex&&n.pageSize&&(s=s.set("pageIndex",n.pageIndex),s=s.set("pageSize",n.pageSize)),this.httpClient.get(`${this.baseSaleCounterUrl}/${e}/revenues`,{params:s})}};t.\u0275fac=function(n){return new(n||t)(D(P))},t.\u0275prov=I({token:t,factory:t.\u0275fac,providedIn:"root"});let i=t;return i})();var ke=(()=>{let t=class t{constructor(e){this.httpClient=e,this.baseRevenueUrl=Me.baseApiUrl.concat("/saleCounters")}getRevenueByDate(e){return this.httpClient.get(`${this.baseRevenueUrl}/bydate?revenueDate=${e}`)}};t.\u0275fac=function(n){return new(n||t)(D(P))},t.\u0275prov=I({token:t,factory:t.\u0275fac,providedIn:"root"});let i=t;return i})();var qe=["saleCountersStatusDropdownRef"],ze=["nameSearchInputRef"];function Qe(i,t){i&1&&(o(0,"div")(1,"p"),l(2,"Kh\xF4ng c\xF3 qu\u1EA7y n\xE0o"),a()())}function He(i,t){if(i&1){let r=_();o(0,"app-card-sale-counter",14),m("onAssignEmployeeId",function(n){p(r);let s=T();return d(s.onAssignEmployeeIdFromParent(n))}),a()}if(i&2){let r=t.$implicit,e=T();u("saleCounter",r)("revenue",e.getRevenueByCounterId(r.id))("selectedDate",e.selectedDate)}}var h,O=(h=class{constructor(t,r,e,n){this.counterService=t,this.revenueService=r,this.notificationService=e,this.datePipe=n,this.selectedDate=this.datePipe.transform(new Date,"yyyy-MM-dd").toString(),this.saleCounterParams={pageSize:5,pageIndex:0,status:!0,searchName:void 0,revenueDate:void 0}}ngOnInit(){this.loadSaleCounters(),this.getRevenueByDate(this.selectedDate),this.loadSaleCountersStatusDropdown()}onDateChange(t){var r=t.value;this.selectedDate=this.datePipe.transform(r,"yyyy-MM-dd").toString(),this.getRevenueByDate(this.selectedDate)}loadSaleCountersStatusDropdown(){this.saleCountersStatusDropdown=[{name:"C\xF2n ho\u1EA1t \u0111\u1ED9ng",value:!0},{name:"Kh\xF4ng ho\u1EA1t \u0111\u1ED9ng",value:!1}]}loadSaleCounters(){this.saleCounters$=this.counterService.getCounters(Q({},this.saleCounterParams))}onSelectChangeStatusFromParent(t){this.saleCounterParams.status=t?.value,this.loadSaleCounters()}onValueChangesNameFromParent(t){this.saleCounterParams.searchName=t,this.loadSaleCounters()}onResetFilters(){this.saleCountersStatusDropdownRef.onClearSelection(),this.nameSearchInputRef.onClearInputFilter(),this.saleCounterParams.searchName=void 0,this.saleCounterParams.status=void 0,this.loadSaleCounters()}onAssignEmployeeIdFromParent(t){this.counterService.assignEmployeeIdToCounter(t).pipe(k(this)).subscribe({next:r=>{this.loadSaleCounters(),r.userId?this.notificationService.show(`\u0110\xE3 ch\u1EC9 \u0111\u1ECBnh qu\u1EA7y ${r.name} cho nh\xE2n vi\xEAn ${r.userName}`):this.notificationService.show(`H\u1EE7y ch\u1EC9 \u0111\u1ECBnh cho qu\u1EA7y ${r.name}`)},error:r=>{this.notificationService.show(r.error.message)}})}getRevenueByDate(t){this.revenueService.getRevenueByDate(t).subscribe({next:r=>{this.saleCounterRevenue=r},error:r=>this.notificationService.show(r.error.message)})}getRevenueByCounterId(t){var r=this.saleCounterRevenue.find(e=>e.saleCounterId===t);return r?.revenue}},h.\u0275fac=function(r){return new(r||h)(g(Ve),g(ke),g(we),g(b))},h.\u0275cmp=E({type:h,selectors:[["app-counters"]],viewQuery:function(r,e){if(r&1&&(B(qe,5),B(ze,5)),r&2){let n;$(n=j())&&(e.saleCountersStatusDropdownRef=n.first),$(n=j())&&(e.nameSearchInputRef=n.first)}},standalone:!0,features:[re([ce(),b]),w],decls:24,vars:8,consts:[["saleCountersStatusDropdownRef",""],["nameSearchInputRef",""],["picker",""],[1,"filter-controls","u-margin-bottom-small","mat-elevation-z2"],[1,"filter-controls__dropdowns"],["label","Ch\u1ECDn hi\u1EC7n tr\u1EA1ng",3,"onSelectionChange","options"],[1,"filter-controls__filter-and-reset"],["label","T\xECm ki\u1EBFm theo t\xEAn",3,"onValueChanges"],["matInput","",3,"dateChange","matDatepicker"],["matIconSuffix","",3,"for"],[1,"btn","btn--primary-dark","btn--with-icon",3,"click"],[1,"grid","grid--responsive","u-margin-top-small"],[4,"ngIf"],[3,"saleCounter","revenue","selectedDate"],[3,"onAssignEmployeeId","saleCounter","revenue","selectedDate"]],template:function(r,e){if(r&1){let n=_();o(0,"section",3)(1,"div",4)(2,"app-generic-dropdown",5,0),m("onSelectionChange",function(f){return p(n),d(e.onSelectChangeStatusFromParent(f))}),a(),o(4,"div",6)(5,"app-generic-search",7,1),m("onValueChanges",function(f){return p(n),d(e.onValueChangesNameFromParent(f))}),a(),o(7,"mat-form-field")(8,"mat-label"),l(9,"Ch\u1ECDn doanh thu theo ng\xE0y"),a(),o(10,"input",8),m("dateChange",function(f){return p(n),d(e.onDateChange(f))}),a(),ee(11,"mat-datepicker-toggle",9)(12,"mat-datepicker",null,2),a(),o(14,"button",10),m("click",function(){return p(n),d(e.onResetFilters())}),o(15,"mat-icon"),l(16,"filter_alt_off"),a(),l(17,"X\xF3a b\u1ED9 l\u1ECDc"),a()()()(),o(18,"section",11),J(19,Qe,3,0,"div",12),v(20,"async"),Y(21,He,1,3,"app-card-sale-counter",13,W),v(23,"async"),a()}if(r&2){let n=te(13);c(2),u("options",e.saleCountersStatusDropdown),c(8),u("matDatepicker",n),c(),u("for",n),c(8),u("ngIf",q(20,4,e.saleCounters$)===null),c(2),Z(q(23,6,e.saleCounters$))}},dependencies:[R,F,ae,se,Re,A,U,Pe,be,Fe,xe,me,de,ue,pe,he,Ce]}),h);O=S([V()],O);var Ge=[{path:"",component:O}],xt=(()=>{let t=class t{};t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=K({type:t}),t.\u0275inj=H({imports:[z.forChild(Ge),z]});let i=t;return i})();export{xt as CountersRoutingModule};
