import{a as w,b as y}from"./chunk-DQDUUP7C.js";import{a as q}from"./chunk-SDQNOOQT.js";import{a as j}from"./chunk-PSUWAX6J.js";import{o as N}from"./chunk-PT53JIWA.js";import"./chunk-S4RKVEPS.js";import"./chunk-QVLUA4QC.js";import"./chunk-VDIAIRGD.js";import{a as M}from"./chunk-V5J7M4I7.js";import"./chunk-IMZNUD52.js";import{a as V}from"./chunk-5LB5J5WN.js";import{a as z}from"./chunk-JWFBI43Q.js";import"./chunk-BRZQVLQ6.js";import"./chunk-J3BG4ZKK.js";import"./chunk-FXF7DOH7.js";import"./chunk-JJPOC4CD.js";import"./chunk-F2JFFDTT.js";import"./chunk-IJCGWU3B.js";import"./chunk-RGNDWIHZ.js";import"./chunk-J7DIVVOQ.js";import{j as T,n as S}from"./chunk-Y2G3PEDF.js";import{D as F,Ga as a,Ha as s,Hb as g,Rb as c,Sb as l,Xb as R,_b as p,a as D,b,fc as h,gc as C,hc as f,jc as P,ma as v,mb as m,nb as _,sc as Q,xa as I,ya as E}from"./chunk-5JFLDQZH.js";var A=["subCategoriesDropdownRef"],B=["categoriesDropdownRef"],K=["statusDropdownRef"],O=["sortsQuantityDropdownRef"],G=(()=>{let i=class i{constructor(e,o,t){this.productService=e,this.route=o,this.notificationService=t,this.columnsToDisplay=["id","name","categoryName","subCategoryName","saleCounterName","quantity","productPrice","status","edit","delete"],this.productParams={pageSize:10,pageIndex:0,searchName:void 0,goldTypeId:void 0,subCategoryId:void 0,sortQuantity:void 0,categoryId:void 0,status:void 0},this.totalProducts=0,this.dataSource=new N([])}ngOnInit(){this.loadProducts(),this.loadSubCategoriesDropdown(),this.loadCategoriesDropdown(),this.loadStatusDropdown(),this.loadSortQuantityDropdown()}loadProducts(){this.productService.getProducts(b(D({},this.productParams),{pageIndex:this.productParams.pageIndex+1})).subscribe({next:e=>{this.dataSource.data=e.data,this.dataSource._updateChangeSubscription(),this.totalProducts=e.count}})}loadSortQuantityDropdown(){this.sortsQuantityDropdown=[{name:"\u2193 S\u1ED1 l\u01B0\u1EE3ng: gi\u1EA3m d\u1EA7n",value:y.QuantityDesc},{name:"\u2191 S\u1ED1 l\u01B0\u1EE3ng: t\u0103ng d\u1EA7n",value:y.QuantityAsc}]}loadSubCategoriesDropdown(){this.productService.getSubCategories().pipe(F(e=>e.map(o=>({value:o.id,name:o.name})))).subscribe({next:e=>{this.subCategoriesDropdown=e},error(e){console.error(e)}})}loadCategoriesDropdown(){this.productService.getCategories().subscribe({next:e=>{this.categoriesDropdown=e.map(o=>({value:o.id,name:o.name}))},error(e){console.error(e)}})}loadStatusDropdown(){this.statusDropdown=[{name:"\u0110ang b\xE1n",value:w.Available},{name:"Kh\xF4ng c\xF2n b\xE1n",value:w.Unavailable}]}onPageChange(e){this.productParams.pageIndex=e.pageIndex,this.productParams.pageSize=e.pageSize,this.loadProducts()}onValueChangesNameFromParent(e){let o=e.target?.value;this.productParams.searchName=o,this.onResetPaginatorToFirstPage(),this.loadProducts()}onSelectChangeSubCategoryIdFromParent(e){this.productParams.subCategoryId=e?.value,this.onResetPaginatorToFirstPage(),this.loadProducts()}onSelectChangeCategoryIdFromParent(e){this.productParams.categoryId=e?.value,this.onResetPaginatorToFirstPage(),this.loadProducts()}onSelectChangeStatusFromParent(e){this.productParams.status=e?.value,this.onResetPaginatorToFirstPage(),this.loadProducts()}onSelectChangeSortQuantityFromParent(e){this.productParams.sortQuantity=e?.value,this.onResetPaginatorToFirstPage(),this.loadProducts()}onProductByIdFromParent(e){let o=e;this.route.navigate([this.route.url+"/"+o])}onDisableProduct(e){this.productService.disableProduct(e.id).subscribe({next:o=>{this.notificationService.show(`Disable Product ${e.name} successfully`),this.loadProducts()}})}onEditProduct(e){this.notificationService.show("T\xEDnh n\u0103ng hi\u1EC7n \u0111ang b\u1EA3o tr\xEC.")}onResetPaginatorToFirstPage(){this.productParams.pageIndex=0,this.dataSource.paginator&&this.dataSource.paginator.firstPage()}onResetFilters(){this.subCategoriesDropdownRef.onClearSelection(),this.categoriesDropdownRef.onClearSelection(),this.sortsQuantityDropdownRef.onClearSelection(),this.statusDropdownRef.onClearSelection(),this.productParams.searchName=void 0,this.productParams.subCategoryId=void 0,this.productParams.categoryId=void 0,this.productParams.sortQuantity=void 0,this.loadProducts()}};i.\u0275fac=function(o){return new(o||i)(_(q),_(T),_(M))},i.\u0275cmp=I({type:i,selectors:[["app-products-management"]],viewQuery:function(o,t){if(o&1&&(h(A,5),h(B,5),h(K,5),h(O,5)),o&2){let n;C(n=f())&&(t.subCategoriesDropdownRef=n.first),C(n=f())&&(t.categoriesDropdownRef=n.first),C(n=f())&&(t.statusDropdownRef=n.first),C(n=f())&&(t.sortsQuantityDropdownRef=n.first)}},standalone:!0,features:[Q],decls:16,vars:9,consts:[["subCategoriesDropdownRef",""],["categoriesDropdownRef",""],["statusDropdownRef",""],["sortsQuantityDropdownRef",""],[1,"filter-controls","u-margin-bottom-small","mat-elevation-z2"],[1,"filter-controls__dropdowns"],["label","Ch\u1ECDn danh m\u1EE5c con",3,"onSelectionChange","options"],["label","Ch\u1ECDn danh m\u1EE5c",3,"onSelectionChange","options"],["label","Ch\u1ECDn hi\u1EC7n tr\u1EA1ng",3,"onSelectionChange","options"],["label","S\u1EAFp x\u1EBFp s\u1ED1 l\u01B0\u1EE3ng",3,"onSelectionChange","options"],[1,"filter-controls__filter-and-reset"],[1,"btn","btn--primary-dark","btn--with-icon",3,"click"],[3,"onPageChangeFromChild","onFilterFromChild","onDisableFromChild","onEditFromChild","onIdGetFromChild","columnsToDisplay","dataSource","pageSize","pageIndex","count"]],template:function(o,t){if(o&1){let n=R();c(0,"section",4)(1,"div",5)(2,"app-generic-dropdown",6,0),p("onSelectionChange",function(r){return a(n),s(t.onSelectChangeSubCategoryIdFromParent(r))}),l(),c(4,"app-generic-dropdown",7,1),p("onSelectionChange",function(r){return a(n),s(t.onSelectChangeCategoryIdFromParent(r))}),l(),c(6,"app-generic-dropdown",8,2),p("onSelectionChange",function(r){return a(n),s(t.onSelectChangeStatusFromParent(r))}),l(),c(8,"app-generic-dropdown",9,3),p("onSelectionChange",function(r){return a(n),s(t.onSelectChangeSortQuantityFromParent(r))}),l(),c(10,"div",10)(11,"button",11),p("click",function(){return a(n),s(t.onResetFilters())}),c(12,"mat-icon"),P(13,"filter_alt_off"),l(),P(14,"X\xF3a b\u1ED9 l\u1ECDc"),l()()()(),c(15,"app-generic-table-data-source",12),p("onPageChangeFromChild",function(r){return a(n),s(t.onPageChange(r))})("onFilterFromChild",function(r){return a(n),s(t.onValueChangesNameFromParent(r))})("onDisableFromChild",function(r){return a(n),s(t.onDisableProduct(r))})("onEditFromChild",function(r){return a(n),s(t.onEditProduct(r))})("onIdGetFromChild",function(r){return a(n),s(t.onProductByIdFromParent(r))}),l()}o&2&&(m(2),g("options",t.subCategoriesDropdown),m(2),g("options",t.categoriesDropdown),m(2),g("options",t.statusDropdown),m(2),g("options",t.sortsQuantityDropdown),m(7),g("columnsToDisplay",t.columnsToDisplay)("dataSource",t.dataSource)("pageSize",t.productParams.pageSize)("pageIndex",t.productParams.pageIndex)("count",t.totalProducts))},dependencies:[j,z,V]});let d=i;return d})();var U=[{path:"",component:G},{path:":id",loadChildren:()=>import("./chunk-N3MKURJO.js").then(d=>d.ProductDetailsRoutingModule)}],re=(()=>{let i=class i{};i.\u0275fac=function(o){return new(o||i)},i.\u0275mod=E({type:i}),i.\u0275inj=v({imports:[S.forChild(U),S]});let d=i;return d})();export{re as ProductsManagementRoutingModule};
