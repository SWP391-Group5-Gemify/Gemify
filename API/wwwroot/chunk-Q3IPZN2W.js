import{a as st,b as j}from"./chunk-R2WOP35W.js";import{a as L}from"./chunk-J3BG4ZKK.js";import{a as et,b as D}from"./chunk-Y2G3PEDF.js";import{D as Z,a as A,b as C,e as S,f as re,g as V,ha as tt,la as U,o as J,ra as w,v as Q,zb as H}from"./chunk-5JFLDQZH.js";var R=S(h=>{"use strict";Object.defineProperty(h,"__esModule",{value:!0});h.output=h.exists=h.hash=h.bytes=h.bool=h.number=h.isBytes=void 0;function G(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`positive integer expected, not ${t}`)}h.number=G;function ot(t){if(typeof t!="boolean")throw new Error(`boolean expected, not ${t}`)}h.bool=ot;function nt(t){return t instanceof Uint8Array||t!=null&&typeof t=="object"&&t.constructor.name==="Uint8Array"}h.isBytes=nt;function $(t,...e){if(!nt(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error(`Uint8Array expected of length ${e}, not of length=${t.length}`)}h.bytes=$;function it(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");G(t.outputLen),G(t.blockLen)}h.hash=it;function at(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}h.exists=at;function ct(t,e){$(t);let s=e.outputLen;if(t.length<s)throw new Error(`digestInto() expects output buffer of length at least ${s}`)}h.output=ct;var ne={number:G,bool:ot,bytes:$,hash:it,exists:at,output:ct};h.default=ne});var Pt=S(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});c.add5L=c.add5H=c.add4H=c.add4L=c.add3H=c.add3L=c.add=c.rotlBL=c.rotlBH=c.rotlSL=c.rotlSH=c.rotr32L=c.rotr32H=c.rotrBL=c.rotrBH=c.rotrSL=c.rotrSH=c.shrSL=c.shrSH=c.toBig=c.split=c.fromBig=void 0;var v=BigInt(2**32-1),X=BigInt(32);function W(t,e=!1){return e?{h:Number(t&v),l:Number(t>>X&v)}:{h:Number(t>>X&v)|0,l:Number(t&v)|0}}c.fromBig=W;function ut(t,e=!1){let s=new Uint32Array(t.length),r=new Uint32Array(t.length);for(let o=0;o<t.length;o++){let{h:a,l:n}=W(t[o],e);[s[o],r[o]]=[a,n]}return[s,r]}c.split=ut;var lt=(t,e)=>BigInt(t>>>0)<<X|BigInt(e>>>0);c.toBig=lt;var ht=(t,e,s)=>t>>>s;c.shrSH=ht;var pt=(t,e,s)=>t<<32-s|e>>>s;c.shrSL=pt;var dt=(t,e,s)=>t>>>s|e<<32-s;c.rotrSH=dt;var ft=(t,e,s)=>t<<32-s|e>>>s;c.rotrSL=ft;var bt=(t,e,s)=>t<<64-s|e>>>s-32;c.rotrBH=bt;var kt=(t,e,s)=>t>>>s-32|e<<64-s;c.rotrBL=kt;var yt=(t,e)=>e;c.rotr32H=yt;var mt=(t,e)=>t;c.rotr32L=mt;var Bt=(t,e,s)=>t<<s|e>>>32-s;c.rotlSH=Bt;var gt=(t,e,s)=>e<<s|t>>>32-s;c.rotlSL=gt;var St=(t,e,s)=>e<<s-32|t>>>64-s;c.rotlBH=St;var It=(t,e,s)=>t<<s-32|e>>>64-s;c.rotlBL=It;function wt(t,e,s,r){let o=(e>>>0)+(r>>>0);return{h:t+s+(o/2**32|0)|0,l:o|0}}c.add=wt;var Lt=(t,e,s)=>(t>>>0)+(e>>>0)+(s>>>0);c.add3L=Lt;var xt=(t,e,s,r)=>e+s+r+(t/2**32|0)|0;c.add3H=xt;var _t=(t,e,s,r)=>(t>>>0)+(e>>>0)+(s>>>0)+(r>>>0);c.add4L=_t;var Tt=(t,e,s,r,o)=>e+s+r+o+(t/2**32|0)|0;c.add4H=Tt;var Ot=(t,e,s,r,o)=>(t>>>0)+(e>>>0)+(s>>>0)+(r>>>0)+(o>>>0);c.add5L=Ot;var Et=(t,e,s,r,o,a)=>e+s+r+o+a+(t/2**32|0)|0;c.add5H=Et;var ie={fromBig:W,split:ut,toBig:lt,shrSH:ht,shrSL:pt,rotrSH:dt,rotrSL:ft,rotrBH:bt,rotrBL:kt,rotr32H:yt,rotr32L:mt,rotlSH:Bt,rotlSL:gt,rotlBH:St,rotlBL:It,add:wt,add3L:Lt,add3H:xt,add4L:_t,add4H:Tt,add5H:Et,add5L:Ot};c.default=ie});var At=S(F=>{"use strict";Object.defineProperty(F,"__esModule",{value:!0});F.crypto=void 0;F.crypto=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0});var Ht=S(i=>{"use strict";Object.defineProperty(i,"__esModule",{value:!0});i.randomBytes=i.wrapXOFConstructorWithOpts=i.wrapConstructorWithOpts=i.wrapConstructor=i.checkOpts=i.Hash=i.concatBytes=i.toBytes=i.utf8ToBytes=i.asyncLoop=i.nextTick=i.hexToBytes=i.bytesToHex=i.byteSwap32=i.byteSwapIfBE=i.byteSwap=i.isLE=i.rotl=i.rotr=i.createView=i.u32=i.u8=i.isBytes=void 0;var q=At(),Y=R();function ae(t){return t instanceof Uint8Array||t!=null&&typeof t=="object"&&t.constructor.name==="Uint8Array"}i.isBytes=ae;var ce=t=>new Uint8Array(t.buffer,t.byteOffset,t.byteLength);i.u8=ce;var ue=t=>new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4));i.u32=ue;var le=t=>new DataView(t.buffer,t.byteOffset,t.byteLength);i.createView=le;var he=(t,e)=>t<<32-e|t>>>e;i.rotr=he;var pe=(t,e)=>t<<e|t>>>32-e>>>0;i.rotl=pe;i.isLE=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;var de=t=>t<<24&4278190080|t<<8&16711680|t>>>8&65280|t>>>24&255;i.byteSwap=de;i.byteSwapIfBE=i.isLE?t=>t:t=>(0,i.byteSwap)(t);function fe(t){for(let e=0;e<t.length;e++)t[e]=(0,i.byteSwap)(t[e])}i.byteSwap32=fe;var be=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function ke(t){(0,Y.bytes)(t);let e="";for(let s=0;s<t.length;s++)e+=be[t[s]];return e}i.bytesToHex=ke;var b={_0:48,_9:57,_A:65,_F:70,_a:97,_f:102};function Ct(t){if(t>=b._0&&t<=b._9)return t-b._0;if(t>=b._A&&t<=b._F)return t-(b._A-10);if(t>=b._a&&t<=b._f)return t-(b._a-10)}function ye(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);let e=t.length,s=e/2;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);let r=new Uint8Array(s);for(let o=0,a=0;o<s;o++,a+=2){let n=Ct(t.charCodeAt(a)),u=Ct(t.charCodeAt(a+1));if(n===void 0||u===void 0){let d=t[a]+t[a+1];throw new Error('hex string expected, got non-hex character "'+d+'" at index '+a)}r[o]=n*16+u}return r}i.hexToBytes=ye;var me=()=>V(i,null,function*(){});i.nextTick=me;function Be(t,e,s){return V(this,null,function*(){let r=Date.now();for(let o=0;o<t;o++){s(o);let a=Date.now()-r;a>=0&&a<e||(yield(0,i.nextTick)(),r+=a)}})}i.asyncLoop=Be;function Ut(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}i.utf8ToBytes=Ut;function N(t){return typeof t=="string"&&(t=Ut(t)),(0,Y.bytes)(t),t}i.toBytes=N;function ge(...t){let e=0;for(let r=0;r<t.length;r++){let o=t[r];(0,Y.bytes)(o),e+=o.length}let s=new Uint8Array(e);for(let r=0,o=0;r<t.length;r++){let a=t[r];s.set(a,o),o+=a.length}return s}i.concatBytes=ge;var K=class{clone(){return this._cloneInto()}};i.Hash=K;var Se={}.toString;function Ie(t,e){if(e!==void 0&&Se.call(e)!=="[object Object]")throw new Error("Options should be object or undefined");return Object.assign(t,e)}i.checkOpts=Ie;function we(t){let e=r=>t().update(N(r)).digest(),s=t();return e.outputLen=s.outputLen,e.blockLen=s.blockLen,e.create=()=>t(),e}i.wrapConstructor=we;function Le(t){let e=(r,o)=>t(o).update(N(r)).digest(),s=t({});return e.outputLen=s.outputLen,e.blockLen=s.blockLen,e.create=r=>t(r),e}i.wrapConstructorWithOpts=Le;function xe(t){let e=(r,o)=>t(o).update(N(r)).digest(),s=t({});return e.outputLen=s.outputLen,e.blockLen=s.blockLen,e.create=r=>t(r),e}i.wrapXOFConstructorWithOpts=xe;function _e(t=32){if(q.crypto&&typeof q.crypto.getRandomValues=="function")return q.crypto.getRandomValues(new Uint8Array(t));throw new Error("crypto.getRandomValues must be defined")}i.randomBytes=_e});var Vt=S(l=>{"use strict";Object.defineProperty(l,"__esModule",{value:!0});l.shake256=l.shake128=l.keccak_512=l.keccak_384=l.keccak_256=l.keccak_224=l.sha3_512=l.sha3_384=l.sha3_256=l.sha3_224=l.Keccak=l.keccakP=void 0;var I=R(),_=Pt(),k=Ht(),Gt=[],vt=[],Ft=[],Te=BigInt(0),x=BigInt(1),Oe=BigInt(2),Ee=BigInt(7),Pe=BigInt(256),Ae=BigInt(113);for(let t=0,e=x,s=1,r=0;t<24;t++){[s,r]=[r,(2*s+3*r)%5],Gt.push(2*(5*r+s)),vt.push((t+1)*(t+2)/2%64);let o=Te;for(let a=0;a<7;a++)e=(e<<x^(e>>Ee)*Ae)%Pe,e&Oe&&(o^=x<<(x<<BigInt(a))-x);Ft.push(o)}var[Ce,Ue]=(0,_.split)(Ft,!0),Dt=(t,e,s)=>s>32?(0,_.rotlBH)(t,e,s):(0,_.rotlSH)(t,e,s),jt=(t,e,s)=>s>32?(0,_.rotlBL)(t,e,s):(0,_.rotlSL)(t,e,s);function Nt(t,e=24){let s=new Uint32Array(10);for(let r=24-e;r<24;r++){for(let n=0;n<10;n++)s[n]=t[n]^t[n+10]^t[n+20]^t[n+30]^t[n+40];for(let n=0;n<10;n+=2){let u=(n+8)%10,d=(n+2)%10,f=s[d],g=s[d+1],ee=Dt(f,g,1)^s[u],se=jt(f,g,1)^s[u+1];for(let P=0;P<50;P+=10)t[n+P]^=ee,t[n+P+1]^=se}let o=t[2],a=t[3];for(let n=0;n<24;n++){let u=vt[n],d=Dt(o,a,u),f=jt(o,a,u),g=Gt[n];o=t[g],a=t[g+1],t[g]=d,t[g+1]=f}for(let n=0;n<50;n+=10){for(let u=0;u<10;u++)s[u]=t[n+u];for(let u=0;u<10;u++)t[n+u]^=~s[(u+2)%10]&s[(u+4)%10]}t[0]^=Ce[r],t[1]^=Ue[r]}s.fill(0)}l.keccakP=Nt;var T=class t extends k.Hash{constructor(e,s,r,o=!1,a=24){if(super(),this.blockLen=e,this.suffix=s,this.outputLen=r,this.enableXOF=o,this.rounds=a,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,(0,I.number)(r),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=(0,k.u32)(this.state)}keccak(){k.isLE||(0,k.byteSwap32)(this.state32),Nt(this.state32,this.rounds),k.isLE||(0,k.byteSwap32)(this.state32),this.posOut=0,this.pos=0}update(e){(0,I.exists)(this);let{blockLen:s,state:r}=this;e=(0,k.toBytes)(e);let o=e.length;for(let a=0;a<o;){let n=Math.min(s-this.pos,o-a);for(let u=0;u<n;u++)r[this.pos++]^=e[a++];this.pos===s&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;let{state:e,suffix:s,pos:r,blockLen:o}=this;e[r]^=s,s&128&&r===o-1&&this.keccak(),e[o-1]^=128,this.keccak()}writeInto(e){(0,I.exists)(this,!1),(0,I.bytes)(e),this.finish();let s=this.state,{blockLen:r}=this;for(let o=0,a=e.length;o<a;){this.posOut>=r&&this.keccak();let n=Math.min(r-this.posOut,a-o);e.set(s.subarray(this.posOut,this.posOut+n),o),this.posOut+=n,o+=n}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return(0,I.number)(e),this.xofInto(new Uint8Array(e))}digestInto(e){if((0,I.output)(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){let{blockLen:s,suffix:r,outputLen:o,rounds:a,enableXOF:n}=this;return e||(e=new t(s,r,o,n,a)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=a,e.suffix=r,e.outputLen=o,e.enableXOF=n,e.destroyed=this.destroyed,e}};l.Keccak=T;var m=(t,e,s)=>(0,k.wrapConstructor)(()=>new T(e,t,s));l.sha3_224=m(6,144,224/8);l.sha3_256=m(6,136,256/8);l.sha3_384=m(6,104,384/8);l.sha3_512=m(6,72,512/8);l.keccak_224=m(1,144,224/8);l.keccak_256=m(1,136,256/8);l.keccak_384=m(1,104,384/8);l.keccak_512=m(1,72,512/8);var Mt=(t,e,s)=>(0,k.wrapXOFConstructorWithOpts)((r={})=>new T(e,t,r.dkLen===void 0?s:r.dkLen,!0));l.shake128=Mt(31,168,128/8);l.shake256=Mt(31,136,256/8)});var zt=S((Ze,B)=>{"use strict";var{sha3_512:He}=Vt(),Rt=24,O=32,z=(t=4,e=Math.random)=>{let s="";for(;s.length<t;)s=s+Math.floor(e()*36).toString(36);return s};function Xt(t){let e=8n,s=0n;for(let r of t.values()){let o=BigInt(r);s=(s<<e)+o}return s}var Wt=(t="")=>Xt(He(t)).toString(36).slice(1),$t=Array.from({length:26},(t,e)=>String.fromCharCode(e+97)),De=t=>$t[Math.floor(t()*$t.length)],qt=({globalObj:t=typeof global<"u"?global:typeof window<"u"?window:{},random:e=Math.random}={})=>{let s=Object.keys(t).toString(),r=s.length?s+z(O,e):z(O,e);return Wt(r).substring(0,O)},Kt=t=>()=>t++,je=476782367,Yt=({random:t=Math.random,counter:e=Kt(Math.floor(t()*je)),length:s=Rt,fingerprint:r=qt({random:t})}={})=>function(){let a=De(t),n=Date.now().toString(36),u=e().toString(36),d=z(s,t),f=`${n+d+u+r}`;return`${a+Wt(f).substring(1,s)}`},Ge=Yt(),ve=(t,{minLength:e=2,maxLength:s=O}={})=>{let r=t.length,o=/^[0-9a-z]+$/;try{if(typeof t=="string"&&r>=e&&r<=s&&o.test(t))return!0}finally{}return!1};B.exports.getConstants=()=>({defaultLength:Rt,bigLength:O});B.exports.init=Yt;B.exports.createId=Ge;B.exports.bufToBigInt=Xt;B.exports.createCounter=Kt;B.exports.createFingerprint=qt;B.exports.isCuid=ve});var Jt=S((ts,E)=>{"use strict";var{createId:Fe,init:Ne,getConstants:Me,isCuid:Ve}=zt();E.exports.createId=Fe;E.exports.init=Ne;E.exports.getConstants=Me;E.exports.isCuid=Ve});var rt=class{constructor(){this.search="",this.pageIndex=1,this.pageSize=10,this.orderTypeId=0,this.startDate=null,this.endDate=null,this.status=""}},p=function(t){return t[t.SELL=1]="SELL",t[t.BUYBACK=2]="BUYBACK",t[t.EXCHANGE=3]="EXCHANGE",t}(p||{}),oe=function(t){return t.PaymentReceived="Thanh To\xE1n Th\xE0nh C\xF4ng",t.PaymentFailed="Thanh To\xE1n Th\u1EA5t B\u1EA1i",t.Pending="\u0110ang X\u1EED L\xFD",t}(oe||{});var Qt=re(Jt());var M=class{constructor(){this.id=(0,Qt.createId)(),this.orderTypeId=p.SELL,this.saleItems=[],this.buybackItems=[]}};var Zt=(()=>{let e=class e{constructor(r){this.httpClient=r,this.baseMembershipApi=L.baseApiUrl.concat("/memberships")}getMembershipById(r){return this.httpClient.get(`${this.baseMembershipApi}/${r}`)}};e.\u0275fac=function(o){return new(o||e)(w(D))},e.\u0275prov=U({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var y,te=(y=class{constructor(e,s){this.httpClient=e,this.membershipService=s,this.baseBasketUrl=L.baseApiUrl.concat("/basket"),this.basePaymentUrl=L.baseApiUrl.concat("/payments"),this.LOCAL_STORAGE_BASKET_ID="basket_id",this._basketSource=new J(null),this.basketSource$=this._basketSource.asObservable(),this.basketSellTotalPrice=H({subTotal:0,total:0,promotionDiscount:0,membershipDiscount:0}),this.basketBuybackTotalPrice=H({totalGoldsWeight:0,totalGoldsPrice:0,totalRareGemsPrice:0,total:0}),this.basketExchangeTotalPrice=H({totalBuyBacks:0,totalSells:0,total:0})}setPromotionId(e){let s=this.getCurrentBasketValue();if(s){s.promotionId=e?e.id:void 0;let r=e?e.discount:0;this.basketSellTotalPrice.update(o=>C(A({},o),{promotionDiscount:r})),this.calculateBasketSellTotalPrice(),this.setOrUpdateBasket(s)}}setMembershipId(e){let s=this.getCurrentBasketValue();s&&(s.membershipId=e?e.membershipId:1,this.membershipService.getMembershipById(s.membershipId).pipe(j(this)).subscribe(r=>{let o=r.discount;this.basketSellTotalPrice.update(a=>C(A({},a),{membershipDiscount:o})),this.calculateBasketSellTotalPrice(),this.setOrUpdateBasket(s)}))}createPaymentIntent(e){return this.httpClient.post(`${this.basePaymentUrl}/${e}`,{}).pipe(Z(s=>{console.table(s),this._basketSource.next(s)}))}selectBasketBeCurrentBasket(e){this._basketSource.next(e),localStorage.setItem(this.LOCAL_STORAGE_BASKET_ID,e.id)}loadBasketById(e){return this.httpClient.get(`${this.baseBasketUrl}/${e}`).pipe(j(this)).subscribe({next:s=>this._basketSource.next(s)})}getBasketById(e){return this.httpClient.get(`${this.baseBasketUrl}/${e}`)}get currentBasketIdLocalStorage(){return localStorage.getItem(this.LOCAL_STORAGE_BASKET_ID)}setOrUpdateBasket(e){return this.httpClient.post(this.baseBasketUrl,e).pipe(j(this)).subscribe({next:s=>{console.log("BEFORE NEXT: ",s),this._basketSource.next(s),console.log("AFTER NEXT: ",this._basketSource.getValue())}})}deleteBasket(e){let s=new et;return s=s.set("id",e.toString()),this.httpClient.delete(this.baseBasketUrl,{params:s}).pipe(tt(()=>{this.getCurrentBasketValue()?.id===e&&(this._basketSource.next(null),localStorage.removeItem(this.LOCAL_STORAGE_BASKET_ID))}))}createEmptyBasketWithPhoneNumber(e,s){let r=new M;return e&&(r.phoneNumber=e),r.orderTypeId=s??p.SELL,this.setOrUpdateBasket(r),r}addOrUpdateBasketItem(e,s,r){let o=e.find(a=>a.id===s.id);return o?o.quantity+=r:(s.quantity=r,e.push(s)),e}getCurrentBasketValue(){return this._basketSource.getValue()}isProduct(e){return e.description!=null}mapProductItemToBasketItemSell(e){return{id:e.id,price:e.productPrice,productName:e.name,quantity:0,pictureUrl:e.imageUrl}}addProductItemToCurrentSellBasket(e,s=1){this.isProduct(e)&&(e=this.mapProductItemToBasketItemSell(e));let r=this.getCurrentBasketValue()??this.createEmptyBasketWithPhoneNumber(void 0,p.SELL);r.saleItems=this.addOrUpdateBasketItem(r?.saleItems,e,s),this.setOrUpdateBasket(r)}addOrderItemToCurrentBuyBackBasket(e,s=1,r,o,a,n){let u=this.calculateOrderItemForBuyBackItemPrice(e,o,r),d=this.mapOrderItemToBasketItemBuyBack(e,u,r,a??0,n),f=this.getCurrentBasketValue()??this.createEmptyBasketWithPhoneNumber(void 0,p.BUYBACK);f.buybackItems=this.addOrUpdateBasketItem(f?.buybackItems,d,s),this.setOrUpdateBasket(f)}mapOrderItemToBasketItemBuyBack(e,s,r,o,a){return{id:e.id,productName:e.productName,price:s,quantity:0,pictureUrl:e.image_Url,goldWeight:r,goldTypeId:o,subCategoryId:a,gems:e.orderItemGems.filter(n=>n.isProcurable).map((n,u)=>({gemId:u,gemName:n.gemName,gemPrice:n.price}))}}addOrderItemToCurrentExchangeBasket(e,s=1,r,o){let a=this.mapOrderItemToBasketItemBuyBack(e,e.price,e.goldWeight,r??0,o),n=this.getCurrentBasketValue()??this.createEmptyBasketWithPhoneNumber(void 0,p.EXCHANGE);n.buybackItems=this.addOrUpdateBasketItem(n?.buybackItems,a,s),this.setOrUpdateBasket(n)}getBaskets(){return this.httpClient.get(this.baseBasketUrl)}resetBasketSellTotalPrice(){this.basketSellTotalPrice.set({subTotal:0,total:0,membershipDiscount:0,promotionDiscount:0})}resetBasketBuyBackTotalPrice(){this.basketBuybackTotalPrice.set({totalGoldsPrice:0,total:0,totalGoldsWeight:0,totalRareGemsPrice:0})}generateTempTicketId(e){let s="";switch(e.orderTypeId){case p.SELL:{s=s.concat("SE");break}case p.BUYBACK:{s=s.concat("BB");break}case p.EXCHANGE:{s=s.concat("EX");break}}return s=s.concat(".").concat(e.phoneNumber.slice(0,4).toUpperCase()),s}calculateBasketExchangeTotalPrice(){this.calculateBasketSellTotalPrice(),this.calculateBasketBuyBackTotalPrice();let e=this.basketSellTotalPrice().total,s=this.basketBuybackTotalPrice().total,r=0;e>=s?r=e-s*1:r=s*.7-e,this.basketExchangeTotalPrice.set({totalSells:e,totalBuyBacks:s,total:r})}calculateBasketSellTotalPrice(){let e=this.getCurrentBasketValue();if(!e)return;let s=e.saleItems.reduce((r,o)=>r+o.price*o.quantity,0);this.basketSellTotalPrice.update(r=>({promotionDiscount:r.promotionDiscount,membershipDiscount:r.membershipDiscount,subTotal:s,total:s*(1-(r.promotionDiscount??0)-(r.membershipDiscount??0))}))}calculateBasketBuyBackTotalPrice(){let e=this.getCurrentBasketValue();if(!e)return;let s=e.buybackItems.reduce((r,o)=>r+=o.price*o.quantity,0);this.basketBuybackTotalPrice.update(r=>C(A({},r),{total:s}))}calculateOrderItemForBuyBackItemPrice(e,s,r){let o=0;e.orderItemGems.length>0&&(o=e.orderItemGems.reduce((n,u)=>u.isProcurable?n+=u.price*.7*u.quantity:n,0));let a=r*s+o;return this.basketBuybackTotalPrice.update(n=>({totalGoldsWeight:n.totalGoldsWeight+r,totalGoldsPrice:n.totalGoldsPrice+r*s,totalRareGemsPrice:n.totalRareGemsPrice+o,total:n.total+a})),a}},y.\u0275fac=function(s){return new(s||y)(w(D),w(Zt))},y.\u0275prov=U({token:y,factory:y.\u0275fac,providedIn:"root"}),y);te=Q([st()],te);export{rt as a,p as b,oe as c,te as d};
