import{a as B,b as je}from"./chunk-2T4HL4PU.js";import"./chunk-O3JVDQH2.js";import{a as Se}from"./chunk-PSUWAX6J.js";import{a as qe}from"./chunk-PG44M7GV.js";import{a as Te,b as Oe,c as Be}from"./chunk-6WZ6ERAC.js";import{o as be}from"./chunk-PT53JIWA.js";import{a as Ve,b as k}from"./chunk-HGUFSTVI.js";import"./chunk-S4RKVEPS.js";import{a as j,b as h}from"./chunk-HXRZ6FVE.js";import{a as ve,b as De,c as Fe,d as Ie,e as Ne,f as we,g as xe}from"./chunk-FJL2MCY3.js";import{a as ke,b as Pe,c as Re,h as Ae}from"./chunk-F4T2NXLS.js";import{a as Ee}from"./chunk-3LYTN6OR.js";import"./chunk-QVLUA4QC.js";import{b as ge,c as x}from"./chunk-VDIAIRGD.js";import{a as T}from"./chunk-V5J7M4I7.js";import{c as Ce}from"./chunk-IMZNUD52.js";import{a as ye}from"./chunk-5LB5J5WN.js";import{a as Me}from"./chunk-JWFBI43Q.js";import{b as _e}from"./chunk-BRZQVLQ6.js";import{a as O,b as f}from"./chunk-R2WOP35W.js";import"./chunk-J3BG4ZKK.js";import{a as ue,c as ce,d as fe,g as he,h as w}from"./chunk-FXF7DOH7.js";import"./chunk-JJPOC4CD.js";import"./chunk-F2JFFDTT.js";import{b as ie,d as a,g as oe,h as re,k as ae,m as ne,o as le,q as me,r as de,s as pe}from"./chunk-IJCGWU3B.js";import"./chunk-RGNDWIHZ.js";import"./chunk-J7DIVVOQ.js";import{ba as se,n as q}from"./chunk-Y2G3PEDF.js";import{D as z,Fb as $,Ga as v,Ha as D,Hb as c,Nb as H,P as L,Pb as K,Qb as J,Rb as r,Sb as i,Tb as u,Ub as Q,Vb as W,Xb as R,_b as E,a as y,ac as A,ad as te,b as V,dc as X,dd as I,gd as N,ic as Z,jc as n,kc as b,ma as U,mb as d,nb as p,rc as ee,sc as F,v as M,xa as S,ya as Y,z as G}from"./chunk-5JFLDQZH.js";function $e(s,t){if(s&1){let e=R();Q(0),r(1,"app-generic-dropdown",17),E("onSelectionChange",function(l){v(e);let m=A();return D(m.onSelectionChangeRoleNameFromParent(l))}),i(),r(2,"mat-form-field",7)(3,"mat-label"),n(4,"T\xEAn ng\u01B0\u1EDDi d\xF9ng"),i(),u(5,"input",18),i(),r(6,"mat-form-field",7)(7,"mat-label"),n(8,"M\u1EADt kh\u1EA9u"),i(),u(9,"input",19),i(),W()}if(s&2){let e=A();d(),c("options",e.roleOptions)}}function He(s,t){if(s&1&&(r(0,"mat-radio-button",6),n(1),i()),s&2){let e=t.$implicit;X("value",e.id),d(),b(e.name)}}var g,_=(g=class{constructor(t,e,o,l,m,ze){this.formBuilder=t,this.modalConfigFromParent=e,this.modalRef=o,this.employeeService=l,this.datePipe=m,this.notificationService=ze}ngOnInit(){switch(this.employee=this.modalConfigFromParent.initialData??new Ve,this.modalConfigFromParent.mode){case h.Edit:{this.loadFormIfEdit(),this.loadGenderRadioButtons();break}case h.Create:{this.loadRoles(),this.loadGenderRadioButtons(),this.loadFormIfCreate();break}}}isCreateMode(){return this.modalConfigFromParent.mode==h.Create}loadRoles(){this.employeeService.getEmployeeRoles().pipe(f(this)).subscribe(t=>{this.roleOptions=t.map(e=>({value:e.name,name:e.name}))})}loadFormIfEdit(){this.formEditOrCreate=this.formBuilder.group({fullName:[this.employee?.fullName??"",a.required],email:[this.employee?.email??"",[a.required,a.email]],phoneNumber:[this.employee?.phoneNumber??"",a.required],dateOfBirth:[this.employee?.dateOfBirth??"",a.required],address:[this.employee?.address??"",a.required],gender:[this.employee?.gender??B.Male,a.required]})}loadFormIfCreate(){this.formEditOrCreate=this.formBuilder.group({fullName:[this.employee?.fullName??"",a.required],email:[this.employee?.email??"",[a.required,a.email]],phoneNumber:[this.employee?.phoneNumber??"",a.required],dateOfBirth:[this.employee?.dateOfBirth??"",a.required],address:[this.employee?.address??"",a.required],gender:[this.employee?.gender??B.Male,a.required],userName:[this.employee?.userName??"",a.required],password:[this.employee?.password??"",a.required],role:[this.employee?.role??Ee.Seller,a.required],image_url:[this.employee?.image_Url??"wwwroot/my.png",a.required]})}loadGenderRadioButtons(){this.genderOptions=je.enumToObject(B)}onSelectionChangeRoleNameFromParent(t){this.employee.role=t.value}onCloseModal(){this.modalRef.close()}onSaveModal(){if(this.formEditOrCreate.valid){let t=this.datePipe.transform(this.formEditOrCreate.get("dateOfBirth")?.value,"yyyy-MM-dd"),e=V(y(y({},this.employee),this.formEditOrCreate.value),{dateOfBirth:t});this.modalConfigFromParent.mode==h.Edit?this.editEmployee(e):this.createEmployee(e)}}editEmployee(t){this.employeeService.updateEmployee(t).pipe(f(this)).subscribe({next:e=>{this.notificationService.show(`\u0110\xE3 c\u1EADp nh\u1EADt th\xF4ng tin nh\xE2n vi\xEAn #${this.employee?.id}`)},error:e=>{console.error(e),this.notificationService.show("\u0110\xE3 x\u1EA3y ra l\u1ED7i","Th\u1EED l\u1EA1i",5e3)}})}createEmployee(t){console.log(t),this.employeeService.registerNewEmployee(t).pipe(f(this)).subscribe({next:e=>{this.notificationService.show("\u0110\u0103ng k\xFD t\xE0i kho\u1EA3n th\xE0nh c\xF4ng")}})}},g.\u0275fac=function(e){return new(e||g)(p(me),p(De),p(ve),p(k),p(I),p(T))},g.\u0275cmp=S({type:g,selectors:[["app-modal-edit-create-employee"]],standalone:!0,features:[ee([se(),I]),F],decls:42,vars:7,consts:[["picker",""],[1,"form--modal",3,"formGroup"],["mat-dialog-title","",1,"form--modal__title","mat-elevation-z1"],[1,"form--modal__content","u-padding-top-medium"],[4,"ngIf"],["aria-label","Ch\u1ECDn gi\u1EDBi t\xEDnh","formControlName","gender","name","gender"],[3,"value"],["appearance","outline"],["matInput","","formControlName","fullName","name","fullName"],["matInput","","formControlName","email","name","email"],["matInput","","type","tel","formControlName","phoneNumber","name","phoneNumber"],["matInput","","formControlName","dateOfBirth","name","dateOfBirth",3,"matDatepicker"],["matIconSuffix","",3,"for"],["matInput","","formControlName","address","name","address"],[1,"form--modal__controls"],[1,"btn","btn--grad","btn--with-icon",3,"click"],[1,"btn","btn--primary","btn--with-icon",3,"click"],["label","Select Roles",3,"onSelectionChange","options"],["matInput","","type","text","formControlName","userName","name","userName"],["matInput","","type","text","formControlName","password","name","password"]],template:function(e,o){if(e&1){let l=R();r(0,"form",1)(1,"h2",2),n(2),i(),r(3,"mat-dialog-content",3),$(4,$e,10,1,"ng-container",4),r(5,"mat-radio-group",5),K(6,He,2,2,"mat-radio-button",6,H),i(),r(8,"mat-form-field",7)(9,"mat-label"),n(10,"H\u1ECD v\xE0 T\xEAn"),i(),u(11,"input",8),i(),r(12,"mat-form-field",7)(13,"mat-label"),n(14,"Email"),i(),u(15,"input",9),i(),r(16,"mat-form-field",7)(17,"mat-label"),n(18,"S\u1ED1 \u0111i\u1EC7n tho\u1EA1i"),i(),u(19,"input",10),i(),r(20,"mat-form-field",7)(21,"mat-label"),n(22,"Ng\xE0y sinh"),i(),u(23,"input",11),r(24,"mat-hint"),n(25,"MM/DD/YYYY"),i(),u(26,"mat-datepicker-toggle",12)(27,"mat-datepicker",null,0),i(),r(29,"mat-form-field",7)(30,"mat-label"),n(31,"\u0110\u1ECBa ch\u1EC9"),i(),u(32,"textarea",13),i()(),r(33,"mat-dialog-actions",14)(34,"button",15),E("click",function(){return v(l),D(o.onCloseModal())}),r(35,"mat-icon"),n(36,"cancel"),i(),n(37),i(),r(38,"button",16),E("click",function(){return v(l),D(o.onSaveModal())}),r(39,"mat-icon"),n(40,"save"),i(),n(41),i()()()}if(e&2){let l=Z(28);c("formGroup",o.formEditOrCreate),d(2),b(o.modalConfigFromParent.title),d(2),c("ngIf",o.isCreateMode()),d(2),J(o.genderOptions),d(17),c("matDatepicker",l),d(3),c("for",l),d(11),b(o.modalConfigFromParent.closeButtonLabel),d(4),b(o.modalConfigFromParent.saveButtonLabel)}},dependencies:[N,te,w,he,ue,ce,fe,Ce,xe,Ie,we,Ne,x,ge,pe,ae,ie,oe,re,ne,le,Be,Te,Oe,Ae,ke,Pe,Re,qe,ye,Me]}),g);_=M([O()],_);var C,P=(C=class{constructor(t,e,o){this.employeeService=t,this.createOrEditModal=e,this.notificationService=o,this.tableConfig={columnsToDisplay:["image_Url","id","fullName","email","userName","gender","phoneNumber","dateOfBirth","status","address","role","edit","delete"],dataSource:new be,pageIndex:0,pageSize:5,totalEmployees:0}}ngOnInit(){this.loadEmployees(),this.loadRoles()}onPageEvent(t){this.tableConfig.pageIndex=t.pageIndex,this.tableConfig.pageSize=t.pageSize,this.loadEmployees()}onApplyFilter(t){let e=t.target.value;this.tableConfig.dataSource.filter=e.trim(),this.tableConfig.dataSource.paginator&&(this.tableConfig.dataSource.paginator.firstPage(),this.tableConfig.pageIndex=0)}loadEmployees(t){this.employeeService.getEmployees(this.tableConfig.pageIndex+1,this.tableConfig.pageSize,t).pipe(z(e=>(this.tableConfig.pageIndex=e.pageIndex-1,this.tableConfig.pageSize=e.pageSize,this.tableConfig.totalEmployees=e.count,e.data)),L(e=>(console.error("Error comes from: ",e),G([])))).subscribe(e=>{this.tableConfig.dataSource.data=e})}loadRoles(){this.employeeRoles$=this.employeeService.getEmployeeRoles()}onDisableEmployee(t){this.employeeService.disableEmployee(t.id).pipe(f(this)).subscribe({next:e=>{this.loadEmployees()}})}onOpenEditEmployeeModal(t){let e={title:j.EditEmployeeTitle,mode:h.Edit,initialData:y({},t),closeButtonLabel:"Close",saveButtonLabel:"Update an Employee"};this.createOrEditModal.open(_,{width:"80%",height:"80%",enterAnimationDuration:"300ms",exitAnimationDuration:"300ms",disableClose:!0,data:e}).beforeClosed().pipe(f(this)).subscribe(()=>{this.loadEmployees()})}onOpenCreateNewEmployee(){let t={title:j.CreateEmployeeTitle,mode:h.Create,initialData:null,closeButtonLabel:"Close",saveButtonLabel:"Create new Employee"};this.createOrEditModal.open(_,{width:"80%",height:"80%",enterAnimationDuration:"300ms",exitAnimationDuration:"300ms",disableClose:!0,data:t}).beforeClosed().pipe(f(this)).subscribe(()=>{this.loadEmployees()})}},C.\u0275fac=function(e){return new(e||C)(p(k),p(Fe),p(T))},C.\u0275cmp=S({type:C,selectors:[["app-employees"]],standalone:!0,features:[F],decls:4,vars:5,consts:[[1,"employees"],[1,"btn","btn--primary","u-margin-bottom-medium",3,"click"],[3,"onPageChangeFromChild","onFilterFromChild","onDisableFromChild","onEditFromChild","columnsToDisplay","dataSource","pageSize","pageIndex","count"]],template:function(e,o){e&1&&(r(0,"section",0)(1,"button",1),E("click",function(){return o.onOpenCreateNewEmployee()}),n(2,"\u0110\u0103ng K\xFD Nh\xE2n Vi\xEAn"),i(),r(3,"app-generic-table-data-source",2),E("onPageChangeFromChild",function(m){return o.onPageEvent(m)})("onFilterFromChild",function(m){return o.onApplyFilter(m)})("onDisableFromChild",function(m){return o.onDisableEmployee(m)})("onEditFromChild",function(m){return o.onOpenEditEmployeeModal(m)}),i()()),e&2&&(d(3),c("columnsToDisplay",o.tableConfig.columnsToDisplay)("dataSource",o.tableConfig.dataSource)("pageSize",o.tableConfig.pageSize)("pageIndex",o.tableConfig.pageIndex)("count",o.tableConfig.totalEmployees))},dependencies:[N,Se,w,_e,x,de]}),C);P=M([O()],P);var Ke=[{path:"",component:P}],Vt=(()=>{let t=class t{};t.\u0275fac=function(l){return new(l||t)},t.\u0275mod=Y({type:t}),t.\u0275inj=U({imports:[q.forChild(Ke),q]});let s=t;return s})();export{Vt as EmployeesRoutingModule};
