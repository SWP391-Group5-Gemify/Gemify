import{a as Be,b as we,c as Ie,d as Te,e as De,g as Pe}from"./chunk-KDX5VCLX.js";import{a as Me}from"./chunk-FVHDBJXV.js";import{b as ye}from"./chunk-I4Q263QN.js";import{b as H,d as v}from"./chunk-Q3IPZN2W.js";import{a as ce,b as de,c as ue,e as he,f as fe,h as _e,i as ke,j as be,k as Ce,l as ge,n as N}from"./chunk-PT53JIWA.js";import{d as Se}from"./chunk-S4RKVEPS.js";import{a as ve}from"./chunk-64L7DANL.js";import{a as me,b as pe}from"./chunk-3LYTN6OR.js";import"./chunk-QVLUA4QC.js";import"./chunk-VDIAIRGD.js";import{c as S}from"./chunk-IMZNUD52.js";import{a as A,b as le}from"./chunk-5LB5J5WN.js";import{a as Ee}from"./chunk-JWFBI43Q.js";import"./chunk-BRZQVLQ6.js";import{a as j,b as P}from"./chunk-R2WOP35W.js";import"./chunk-J3BG4ZKK.js";import"./chunk-FXF7DOH7.js";import"./chunk-JJPOC4CD.js";import"./chunk-F2JFFDTT.js";import"./chunk-IJCGWU3B.js";import"./chunk-RGNDWIHZ.js";import"./chunk-J7DIVVOQ.js";import{j as se,n as q}from"./chunk-Y2G3PEDF.js";import{D as X,Fb as p,Ga as u,Ha as h,Hb as l,Mb as x,Nb as ee,Pb as te,Qb as ne,Ra as J,Rb as a,Sb as o,Tb as f,Ub as w,Vb as I,Xb as T,_b as c,ac as g,ad as ae,cd as oe,fc as F,fd as re,gc as O,gd as E,hc as R,jb as W,jc as s,kc as $,lc as V,ma as K,mb as m,nb as b,sa as L,sc as y,v as M,wc as D,xa as C,xc as z,ya as Y,yc as ie,zb as Z}from"./chunk-5JFLDQZH.js";function Oe(n,e){n&1&&f(0,"mat-header-cell")}function Re(n,e){if(n&1&&(a(0,"mat-cell"),f(1,"img",9),o()),n&2){let t=e.$implicit;m(),l("src",t.pictureUrl,W)("alt",t.productName)}}function Ve(n,e){n&1&&(a(0,"mat-header-cell"),s(1,"Name"),o())}function Ae(n,e){if(n&1&&(a(0,"mat-cell"),s(1),o()),n&2){let t=e.$implicit;m(),V(" ",t.productName," ")}}function Ne(n,e){n&1&&(a(0,"mat-header-cell"),s(1,"Quantity"),o())}function je(n,e){if(n&1&&(a(0,"mat-cell"),s(1),o()),n&2){let t=e.$implicit;m(),V(" ",t.quantity," ")}}function He(n,e){n&1&&(a(0,"mat-header-cell"),s(1,"Price"),o())}function Ue(n,e){if(n&1&&(a(0,"mat-cell"),s(1),D(2,"currency"),o()),n&2){let t=e.$implicit;m(),V(" ",ie(2,1,t.price,"VND")," ")}}function Qe(n,e){n&1&&f(0,"mat-header-row")}function $e(n,e){n&1&&f(0,"mat-row")}var xe=(()=>{let e=class e{constructor(){this.basketService=L(v),this.displayedColumns=["pictureUrl","productName","quantity","price"]}};e.\u0275fac=function(r){return new(r||e)},e.\u0275cmp=C({type:e,selectors:[["app-table-basket-items"]],inputs:{basketItems:"basketItems"},standalone:!0,features:[y],decls:15,vars:3,consts:[[1,"table-basket-item",3,"dataSource"],["matColumnDef","pictureUrl"],[4,"matHeaderCellDef"],[4,"matCellDef"],["matColumnDef","productName"],["matColumnDef","quantity"],["matColumnDef","price"],[4,"matHeaderRowDef"],[4,"matRowDef","matRowDefColumns"],[1,"table-basket-item__product-img",3,"src","alt"]],template:function(r,d){r&1&&(a(0,"mat-table",0),w(1,1),p(2,Oe,1,0,"mat-header-cell",2)(3,Re,2,2,"mat-cell",3),I(),w(4,4),p(5,Ve,2,0,"mat-header-cell",2)(6,Ae,2,1,"mat-cell",3),I(),w(7,5),p(8,Ne,2,0,"mat-header-cell",2)(9,je,2,1,"mat-cell",3),I(),w(10,6),p(11,He,2,0,"mat-header-cell",2)(12,Ue,3,4,"mat-cell",3),I(),p(13,Qe,1,0,"mat-header-row",7)(14,$e,1,0,"mat-row",8),o()),r&2&&(l("dataSource",d.basketItems),m(13),l("matHeaderRowDef",d.displayedColumns),m(),l("matRowDefColumns",d.displayedColumns))},dependencies:[N,ce,ue,ke,he,de,be,fe,_e,Ce,ge,E,re,le,S]});let n=e;return n})();function qe(n,e){if(n&1){let t=T();a(0,"button",6),c("click",function(){u(t);let r=g();return h(r.onGoToCheckOutPage())}),a(1,"mat-icon"),s(2,"paid"),o(),s(3,"Thanh to\xE1n"),o()}}function Ge(n,e){if(n&1&&(a(0,"p",7),s(1,"H\xE0ng kh\xE1ch mua"),o(),a(2,"div",8),f(3,"app-table-basket-items",9),o()),n&2){let t=g();m(3),l("basketItems",t.basket.saleItems)}}function Xe(n,e){if(n&1&&(a(0,"p",10),s(1,"C\u1EEDa h\xE0ng th\xE2u l\u1EA1i"),o(),a(2,"div",8),f(3,"app-table-basket-items",9),o()),n&2){let t=g();m(3),l("basketItems",t.basket.buybackItems)}}var _,U=(_=class{constructor(e,t,i){this.basketService=e,this.authService=t,this.router=i,this.panelOpenState=Z(!1),this.onDeleteBasketFromChild=new J}onDeleteBasket(){this.basketService.deleteBasket(this.basket.id).pipe(P(this)).subscribe({next:e=>{e&&this.onDeleteBasketFromChild.emit(!0)},error:e=>{this.onDeleteBasketFromChild.emit(!1),console.error(e)}})}isUserCashier(){return this.authService.currentUser()?.role===me.Cashier}onGoToCheckOutPage(){switch(this.basketService.selectBasketBeCurrentBasket(this.basket),this.basket.orderTypeId){case H.SELL:{this.router.navigate(["/cashier/checkout"]);return}case H.BUYBACK:{this.router.navigate(["/cashier/checkout-ex-bb"]);return}case H.EXCHANGE:{this.router.navigate(["/cashier/checkout-ex-bb"]);return}}}},_.\u0275fac=function(t){return new(t||_)(b(v),b(pe),b(se))},_.\u0275cmp=C({type:_,selectors:[["app-card-basket"]],inputs:{basket:"basket"},outputs:{onDeleteBasketFromChild:"onDeleteBasketFromChild"},standalone:!0,features:[y],decls:20,vars:5,consts:[[1,"card-basket","mat-elevation-z0",3,"opened","closed"],[1,"card-basket__header"],[1,"card-basket__actions"],[1,"btn","btn--grad","btn--with-icon",3,"click"],[1,"btn","btn--primary","btn--with-icon"],["matExpansionPanelContent",""],[1,"btn","btn--primary","btn--with-icon",3,"click"],[1,"card-basket__type","u-margin-bottom-small"],[1,"card-basket__items"],[3,"basketItems"],[1,"card-basket__type","u-margin-top-small","u-margin-bottom-small"]],template:function(t,i){t&1&&(a(0,"mat-expansion-panel",0),c("opened",function(){return i.panelOpenState.set(!0)})("closed",function(){return i.panelOpenState.set(!1)}),a(1,"mat-expansion-panel-header",1)(2,"mat-panel-title"),s(3),o(),a(4,"mat-panel-description")(5,"p"),s(6,"S\u1ED1 \u0111i\u1EC7n tho\u1EA1i kh\xE1ch: "),a(7,"span"),s(8),o()(),a(9,"mat-icon"),s(10,"shopping_basket"),o()()(),a(11,"mat-action-row",2)(12,"button",3),c("click",function(){return i.onDeleteBasket()}),a(13,"mat-icon"),s(14,"delete_forever"),o(),s(15,"X\xF3a gi\u1ECF h\xE0ng"),o(),p(16,qe,4,0,"button",4),o(),a(17,"div",5),p(18,Ge,4,1)(19,Xe,4,1),o()()),t&2&&(m(3),$(i.basketService.generateTempTicketId(i.basket)),m(5),$(i.basket.phoneNumber||"NONE"),m(8),x(16,i.isUserCashier()?16:-1),m(2),x(18,i.basket.saleItems.length!==0?18:-1),m(),x(19,i.basket.buybackItems.length!==0?19:-1))},dependencies:[Pe,Be,we,Ie,De,Te,E,A,S,xe],styles:[".card-basket[_ngcontent-%COMP%]{background-color:#f5f5f4}.card-basket__header[_ngcontent-%COMP%]{padding:2.4rem}.card-basket__header[_ngcontent-%COMP%]   mat-panel-title[_ngcontent-%COMP%]{padding:0px .8rem;height:5rem;background-color:#fb923c;color:#f8fafc;font-weight:900;font-size:1.8rem;letter-spacing:1.4px;border-radius:4px;border:1px solid #343638;max-width:10rem;justify-content:center}.card-basket__header[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#fb923c}.card-basket__header[_ngcontent-%COMP%]   mat-panel-description[_ngcontent-%COMP%]{font-size:1.8rem;font-weight:900}.card-basket__header[_ngcontent-%COMP%]   mat-panel-description[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin-left:.8rem;display:inline-block;color:#fb923c;letter-spacing:1.2px}.card-basket__header[_ngcontent-%COMP%]   .mat-expansion-panel-header-description[_ngcontent-%COMP%]{justify-content:space-between;align-items:center}.card-basket__type[_ngcontent-%COMP%]{color:#f5f5f4;font-size:1.6rem;padding:1.2rem;letter-spacing:1.9px;text-transform:capitalize;background-color:#343638;text-align:center}.card-basket__actions[_ngcontent-%COMP%]{gap:1.2rem}"],changeDetection:0}),_);U=M([j()],U);var Ke=["phoneSearchInputRef"],Le=["basketIdAndPhoneDropdownRef"],Ye=["orderTypeDropdownRef"];function Je(n,e){n&1&&(a(0,"div")(1,"p"),s(2,"Kh\xF4ng c\xF3 gi\u1ECF h\xE0ng n\xE0o"),o()())}function We(n,e){if(n&1){let t=T();a(0,"app-card-basket",13),c("onDeleteBasketFromChild",function(r){u(t);let d=g();return h(d.onBasketDeletedFromParent(r))}),o()}if(n&2){let t=e.$implicit;l("basket",t)}}var k,Q=(k=class{constructor(e,t){this.basketService=e,this.orderService=t,this.basketsParams={id:void 0,searchPhoneNumber:void 0,orderTypeId:void 0}}ngOnInit(){this.loadBaskets(),this.loadBasketIdAndPhoneDropdown(),this.loadOrderTypesDropdown()}loadBaskets(){this.baskets$=this.basketService.getBaskets().pipe(X(e=>{let t=e;return this.basketsParams.id&&(t=t.filter(i=>i.id===this.basketsParams.id)),this.basketsParams.searchPhoneNumber&&(t=t.filter(i=>i.phoneNumber&&i.phoneNumber.includes(this.basketsParams.searchPhoneNumber))),this.basketsParams.orderTypeId&&(t=t.filter(i=>i.orderTypeId===this.basketsParams.orderTypeId)),t}))}loadBasketIdAndPhoneDropdown(){this.basketService.getBaskets().pipe(P(this)).subscribe(e=>{this.basketIdAndPhoneDropdown=e.map(t=>({value:t.id,name:this.basketService.generateTempTicketId(t)}))})}loadOrderTypesDropdown(){this.orderService.getOrderTypes().pipe(P(this)).subscribe(e=>{this.orderTypeDropdown=e.map(t=>({value:t.id,name:t.name}))})}onSelectChangeBasketIdAndPhoneFromParent(e){this.basketsParams.id=e?.value,this.loadBaskets()}onSelectChangeOrderTypesFromParent(e){this.basketsParams.orderTypeId=e?.value,this.loadBaskets()}onValueChangesPhoneFromParent(e){this.basketsParams.searchPhoneNumber=e,this.loadBaskets()}onResetFilters(){this.basketIdAndPhoneDropdownRef.onClearSelection(),this.phoneSearchInputRef.onClearInputFilter(),this.orderTypeDropdownRef.onClearSelection(),this.basketsParams.id=void 0,this.basketsParams.searchPhoneNumber=void 0,this.basketsParams.orderTypeId=void 0,this.loadBaskets()}onBasketDeletedFromParent(e){e&&(this.loadBaskets(),this.loadBasketIdAndPhoneDropdown())}},k.\u0275fac=function(t){return new(t||k)(b(v),b(Me))},k.\u0275cmp=C({type:k,selectors:[["app-basket"]],viewQuery:function(t,i){if(t&1&&(F(Ke,5),F(Le,5),F(Ye,5)),t&2){let r;O(r=R())&&(i.phoneSearchInputRef=r.first),O(r=R())&&(i.basketIdAndPhoneDropdownRef=r.first),O(r=R())&&(i.orderTypeDropdownRef=r.first)}},standalone:!0,features:[y],decls:19,vars:7,consts:[["basketIdAndPhoneDropdownRef",""],["orderTypeDropdownRef",""],["phoneSearchInputRef",""],[1,"filter-controls","u-margin-bottom-small","mat-elevation-z2"],[1,"filter-controls__dropdowns"],["label","Ch\u1ECDn m\xE3 gi\u1ECF h\xE0ng",3,"onSelectionChange","options"],["label","Ch\u1ECDn lo\u1EA1i gi\u1ECF h\xE0ng",3,"onSelectionChange","options"],[1,"filter-controls__filter-and-reset"],["label","T\xECm ki\u1EBFm theo s\u1ED1 \u0111i\u1EC7n tho\u1EA1i",3,"onValueChanges"],[1,"btn","btn--primary-dark","btn--with-icon",3,"click"],[1,"grid","grid--2-cols","u-margin-top-small"],[4,"ngIf"],[3,"basket"],[3,"onDeleteBasketFromChild","basket"]],template:function(t,i){if(t&1){let r=T();a(0,"section",3)(1,"div",4)(2,"app-generic-dropdown",5,0),c("onSelectionChange",function(B){return u(r),h(i.onSelectChangeBasketIdAndPhoneFromParent(B))}),o(),a(4,"app-generic-dropdown",6,1),c("onSelectionChange",function(B){return u(r),h(i.onSelectChangeOrderTypesFromParent(B))}),o()(),a(6,"div",7)(7,"app-generic-search",8,2),c("onValueChanges",function(B){return u(r),h(i.onValueChangesPhoneFromParent(B))}),o(),a(9,"button",9),c("click",function(){return u(r),h(i.onResetFilters())}),a(10,"mat-icon"),s(11,"filter_alt_off"),o(),s(12,"X\xF3a b\u1ED9 l\u1ECDc"),o()()(),a(13,"section",10),p(14,Je,3,0,"div",11),D(15,"async"),te(16,We,1,1,"app-card-basket",12,ee),D(18,"async"),o()}if(t&2){let r;m(2),l("options",i.basketIdAndPhoneDropdown),m(2),l("options",i.orderTypeDropdown),m(10),l("ngIf",((r=z(15,3,i.baskets$))==null?null:r.length)===0),m(2),ne(z(18,5,i.baskets$))}},dependencies:[E,ae,oe,S,A,Se,Ee,ve,N,U,ye]}),k);Q=M([j()],Q);var Ze=[{path:"",component:Q}],Xt=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=Y({type:e}),e.\u0275inj=K({imports:[q.forChild(Ze),q]});let n=e;return n})();export{Xt as BasketRoutingModule};
